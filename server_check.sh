#!/usr/bin/env bash
# ==============================================
#  Server Health Check Script
#  Author: eolv
#  Description: –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å Linux-—Å–µ—Ä–≤–µ—Ä–∞ –∫ DevOps/Deploy
# ==============================================

echo "üß≠  –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è $(hostname)"
echo "–î–∞—Ç–∞: $(date)"
echo "---------------------------------------------"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–∏ –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤–∞
echo "[1] üêß –î–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤:"
lsb_release -a 2>/dev/null || cat /etc/os-release
echo "---------------------------------------------"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑–æ–≤—ã—Ö CLI-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
echo "[2] üß∞ CLI-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:"
for cmd in git curl python3 jq docker systemctl; do
  if command -v $cmd &>/dev/null; then
    echo "‚úÖ $cmd ‚Äî –Ω–∞–π–¥–µ–Ω"
  else
    echo "‚ö†Ô∏è $cmd ‚Äî –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç"
  fi
done
echo "---------------------------------------------"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ç–∏
echo "[3] üåê –°–µ—Ç–µ–≤—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã:"
ip -br a | grep -v LOOPBACK
echo "---------------------------------------------"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ Docker
echo "[4] üê≥ Docker —Å–æ—Å—Ç–æ—è–Ω–∏–µ:"
if systemctl is-active --quiet docker; then
  echo "‚úÖ Docker –∑–∞–ø—É—â–µ–Ω"
else
  echo "‚ö†Ô∏è Docker –Ω–µ –∞–∫—Ç–∏–≤–µ–Ω"
fi
echo "---------------------------------------------"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏—Å–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞
echo "[5] üíæ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–∞:"
df -h / | tail -n 1
echo "---------------------------------------------"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞–º—è—Ç–∏
echo "[6] üß† –ü–∞–º—è—Ç—å:"
free -h | awk '/Mem:/ {print "–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è: "$3" –∏–∑ "$2}'
echo "---------------------------------------------"

echo "‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞"
